= content_for(:title, @user.name)

.row
  %aside{:class => "col-md-10"}
    %section{:class => "user_info"}
      %h3= @user.name
      %p
        %br
        You have played 
        =played_games(@user).length 
        games and won 
        =win_games(@user).length 
        of them, 
        =instant_games(@user).length 
        as an instant winner and 
        =whoop_games(@user).length 
        as a whoop winner.
.row
  .col-md-10.col-md-offset-1
    %table.table{:border => 2}
      %thead
        %tr
          %th Game  
          %th Date      
          %th Status
          %th #Gamers
          %th Results
          %th #Whoop Cards
          %th Play Now?
          %th More Info
      %tbody
        - all_games(@user).each do |gu|
        %tr
        - game = gu.game
          %td= game.game_name
          %td= game.date.to_date
          %td= get_state(game)
          %td= game.game_user_ids.length
          %td= check_winner(game, current_user)
          %td= check_num_whoop_cards(game, current_user)
          %td 
            - if game.ongoing?
              =link_to '<button type="button">Play!</button>'.html_safe, user_game_play_path(current_user, game)
            - elsif game.upcoming?
              Wait ..
            - else
              =link_to '<button type="button">Check play history</button>'.html_safe, user_game_play_path(current_user, game)

          %td= link_to "More about #{game.game_name}", game_path(game)